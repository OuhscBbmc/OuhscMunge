<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Upload to a SQL Server database using RODBC — upload_sqls_rodbc • OuhscMunge</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Upload to a SQL Server database using RODBC — upload_sqls_rodbc" />

<meta property="og:description" content="The function performs some extra configuration to improve robustness." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OuhscMunge</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.9.9009</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/OuhscBbmc/OuhscMunge">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Upload to a SQL Server database using RODBC</h1>
    <small class="dont-index">Source: <a href='https://github.com/OuhscBbmc/OuhscMunge/blob/master/R/upload-sqls-rodbc.R'><code>R/upload-sqls-rodbc.R</code></a></small>
    <div class="hidden name"><code>upload_sqls_rodbc.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The function performs some extra configuration to improve robustness.</p>
    
    </div>

    <pre class="usage"><span class='fu'>upload_sqls_rodbc</span>(<span class='no'>d</span>, <span class='no'>table_name</span>, <span class='no'>dsn_name</span>, <span class='kw'>schema_name</span> <span class='kw'>=</span> <span class='fl'>NA_character_</span>,
  <span class='kw'>clear_table</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>create_table</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>convert_logical_to_integer</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>transaction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>Dataset to be uploaded to the dataset.  The object must inherit from <code>data.frame</code>.</p></td>
    </tr>
    <tr>
      <th>table_name</th>
      <td><p>Name of the database destination table.  Can include the schema.</p></td>
    </tr>
    <tr>
      <th>dsn_name</th>
      <td><p>Name of the locally-defined DSN passed to <a href='RODBC::odbcConnect()'>RODBC::odbcConnect()</a>.</p></td>
    </tr>
    <tr>
      <th>schema_name</th>
      <td><p>Name of the database destination table.  If it's not <code>NA</code>, the <code>table_name</code> will be qualified with it.</p></td>
    </tr>
    <tr>
      <th>clear_table</th>
      <td><p>If <code>TRUE</code>, calls <a href='RODBC::sqlClear()'>RODBC::sqlClear()</a> before writing to the table.</p></td>
    </tr>
    <tr>
      <th>create_table</th>
      <td><p>If the table structure has not yet been defined in the database, it will be created if <code>create_table</code> is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>convert_logical_to_integer</th>
      <td><p>Convert all <code>logical</code> columns to <code>integer</code>.  This helps the database store the values as bits.</p></td>
    </tr>
    <tr>
      <th>transaction</th>
      <td><p>Should the clear and upload steps be wrapped in a rollback transaction?</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Write a message about the status of a successful upload.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If <code>transaction</code> is <code>TRUE</code> and the upload fails, the table is rolled back to the state before function was callled.
This includes rolling back the (optional) clearing of records, and uploading the new records.
Decide if it's more robust to rollback to the previous state, or if it's better to leave the table in the incomplete state.
The latter is helpful diagnosing which record caused the write to fail; look at the last successful record contained in the database</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'>requireNamespace</span>(<span class='st'>"OuhscMunge"</span>)

<span class='kw pkg'>OuhscMunge</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/OuhscMunge/topics/upload_sqls_rodbc'>upload_sqls_rodbc</a></span>(
  <span class='kw'>d</span>                          <span class='kw'>=</span> <span class='no'>ds_client</span>,          <span class='co'># Some data.frame that exists in RAM</span>
  <span class='kw'>table_name</span>                 <span class='kw'>=</span> <span class='st'>"tbl_client"</span>,
  <span class='kw'>dsn_name</span>                   <span class='kw'>=</span> <span class='st'>"miechv_eval"</span>,
  <span class='kw'>create_table</span>               <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>clear_table</span>                <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>transaction</span>                <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>verbose</span>                    <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>convert_logical_to_integer</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Will Beasley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

